<%- include('_header',{user}) %>
<div class='container py-4 mt-3'>
    <div class="card p-3 border border-success shadow rounded">
        <div class="row card-body">

        
            <div class="col-md-6 col-sm-12 text-center align-self-center">
                <img src="assets/update_profile.jpg" alt="Login" 
                    fluid width="80%" /> 
                <br>
            </div>
            
                <form action="<%=user.type%>/editProfile/<%=user.uid%>" method="POST" class="col-md-6 col-sm-12">
                    <h2 class="text-center">Edit Information</h2>
                    <hr>
                    <% if (success) { %>
                        <div class="alert alert-success" role="alert">
                            <%=success%>
                        </div>
                    <% } %>
                    <% if (error) { %>
                        <div class="alert alert-danger" role="alert">
                            <%=error%>
                        </div>
                    <% } %>
                    <div class="form-group">
                        <label for='firstName'>First Name</label>
                        <input type='text' name='firstName' value="<%=user.firstName%>" placeholder="First Name" class="form-control" required maxlength="50" style="text-transform: capitalize;">
                    </div>
                    <div class="form-group ">
                        <label for='lastName'>Last Name</label>
                        <input type='text' name='lastName' value="<%=user.lastName%>" placeholder="Last Name" class="form-control" required maxlength="50" style="text-transform: capitalize;">
                    </div>
                    <div class="form-group ">
                        <label for='email'>Email</label>
                        <input type='email' name='email' value="<%=user.email%>" placeholder="Email" class="form-control" required maxlength="50">
                    </div>
                    <div class="form-group">
                        <label for="gender">Gender</label>
                        <select id="gender" class="form-control" name="gender" required>
                            <option  selected>Choose...</option>
                            <% if( user.gender=='Male') { %>
                                <option value="Male" selected>Male</option>
                            <% }else{  %>
                                <option value="Male">Male</option>
                            <% } %>
                            <% if( user.gender=='Female') { %>
                                <option value="Female" selected>Female</option>
                            <% }else{  %>
                                <option value="Female">Female</option>
                            <% } %>
                            <% if( user.gender=='Other') { %>
                                <option value="Other" selected>Other</option>
                            <% }else{  %>
                                <option value="Other">Other</option>
                            <% } %>
                        </select>
                    </div>  
                    <% if(user.type=='farmer') {%>
                    <div class="form-group ">
                        <label for='contactNo'>Contact Number</label>
                        <input type='text' name='contactNo' value="<%=user.farmerData.contact_no%>" placeholder="Contact Number" class="form-control" required maxlength="10">
                    </div>
                    <div class="form-group ">
                        <label for='nicNumber'>NIC Number</label>
                        <input type='text' name='nicNumber' value="<%=user.farmerData.nic%>" placeholder="NIC Number" class="form-control" required maxlength="15" style="text-transform: uppercase;">
                    </div>
                    <div class="form-group">
                        <label for="address">Address</label>
                        <textarea class="form-control" id="address" name="address" rows="3" maxlength="100" style="text-transform: capitalize;"><%=user.farmerData.address%></textarea>
                    </div>  
                    <div class="form-group">
                        <label for="district">Residential District</label>
                        <select id="district" class="form-control" name="district" required>
                            <option  selected>Choose...</option>
                            <option value="Anuradhapura">Anuradhapura</option>
                            <% if( user.farmerData.district=='Ampara') { %>
                            <option value="Ampara" selected>Ampara</option>
                            <% }else{  %>
                            <option value="Ampara">Ampara</option>
                            <% } %>
                            <% if( user.farmerData.district=='Badulla') { %>
                            <option value="Badulla" selected>Badulla</option>
                            <% }else{  %>
                            <option value="Badulla">Badulla</option>
                            <% } %>
                            <% if( user.farmerData.district=='Batticaloa') { %>
                            <option value="Batticaloa" selected>Batticaloa</option>
                            <% }else{  %>
                            <option value="Batticaloa">Batticaloa</option>
                            <% } %>
                            <% if( user.farmerData.district=='Colombo') { %>
                            <option value="Colombo" selected>Colombo</option>
                            <% }else{  %>
                            <option value="Colombo">Colombo</option>
                            <% } %>
                            <% if( user.farmerData.district=='Galle') { %>
                            <option value="Galle" selected>Galle</option>
                            <% }else{  %>
                            <option value="Galle">Galle</option>
                            <% } %>
                            <% if( user.farmerData.district=='Gampaha') { %>
                            <option value="Gampaha" selected>Gampaha</option>
                            <% }else{  %>
                            <option value="Gampaha">Gampaha</option>
                            <% } %>
                            <% if( user.farmerData.district=='Hambantota') { %>
                            <option value="Hambantota" selected>Hambantota</option>
                            <% }else{  %>
                            <option value="Hambantota">Hambantota</option>
                            <% } %>
                            <% if( user.farmerData.district=='Jaffna') { %>
                            <option value="Jaffna" selected>Jaffna</option>
                            <% }else{  %>
                            <option value="Jaffna">Jaffna</option>
                            <% } %>
                            <% if( user.farmerData.district=='Kalutara') { %>
                            <option value="Kalutara" selected>Kalutara</option>
                            <% }else{  %>
                            <option value="Kalutara">Kalutara</option>
                            <% } %>
                            <% if( user.farmerData.district=='Kandy') { %>
                            <option value="Kandy" selected>Kandy</option>
                            <% }else{  %>
                            <option value="Kandy">Kandy</option>
                            <% } %>
                            <% if( user.farmerData.district=='Kegalle') { %>
                            <option value="Kegalle" selected>Kegalle</option>
                            <% }else{  %>
                            <option value="Kegalle">Kegalle</option>
                            <% } %>
                            <% if( user.farmerData.district=='Kilinochchi') { %>
                            <option value="Kilinochchi" selected>Kilinochchi</option>
                            <% }else{  %>
                            <option value="Kilinochchi">Kilinochchi</option>
                            <% } %>
                            <% if( user.farmerData.district=='Kurunegala') { %>
                            <option value="Kurunegala" selected>Kurunegala</option>
                            <% }else{  %>
                            <option value="Kurunegala">Kurunegala</option>
                            <% } %>
                            <% if( user.farmerData.district=='Mannar') { %>
                            <option value="Mannar" selected>Mannar</option>
                            <% }else{  %>
                            <option value="Mannar">Mannar</option>
                            <% } %>
                            <% if( user.farmerData.district=='Matale') { %>
                            <option value="Matale" selected>Matale</option>
                            <% }else{  %>
                            <option value="Matale">Matale</option>
                            <% } %>
                            <% if( user.farmerData.district=='Matara') { %>
                            <option value="Matara" selected>Matara</option>
                            <% }else{  %>
                            <option value="Matara">Matara</option>
                            <% } %><% if( user.farmerData.district=='Moneragala') { %>
                            <option value="Moneragala" selected>Moneragala</option>
                            <% }else{  %>
                            <option value="Moneragala">Moneragala</option>
                            <% } %>
                            <% if( user.farmerData.district=='Mullaitivu') { %>
                            <option value="Mullaitivu" selected>Mullaitivu</option>
                            <% }else{  %>
                            <option value="Mullaitivu">Mullaitivu</option>
                            <% } %>
                            <% if( user.farmerData.district=='Nuwara Eliya') { %>
                            <option value="Nuwara Eliya" selected>Nuwara Eliya</option>
                            <% }else{  %>
                            <option value="Nuwara Eliya">Nuwara Eliya</option>
                            <% } %>
                            <% if( user.farmerData.district=='Polonnaruwa') { %>
                            <option value="Polonnaruwa" selected>Polonnaruwa</option>
                            <% }else{  %>
                            <option value="Polonnaruwa">Polonnaruwa</option>
                            <% } %>
                            <% if( user.farmerData.district=='Puttalam') { %>
                            <option value="Puttalam" selected>Puttalam</option>
                            <% }else{  %>
                            <option value="Puttalam">Puttalam</option>
                            <% } %>
                            <% if( user.farmerData.district=='Ratnapura') { %>
                            <option value="Ratnapura" selected>Ratnapura</option>
                            <% }else{  %>
                            <option value="Ratnapura">Ratnapura</option>
                            <% } %>
                            <% if( user.farmerData.district=='Trincomalee') { %>
                            <option value="Trincomalee" selected>Trincomalee</option>
                            <% }else{  %>
                            <option value="Trincomalee">Trincomalee</option>
                            <% } %>
                            <% if( user.farmerData.district=='Vavuniya') { %>
                            <option value="Vavuniya" selected>Vavuniya</option>
                            <% }else{  %>
                            <option value="Vavuniya">Vavuniya</option>
                            <% } %>
                        </select>
                      </div>
                    <%}%>
                    <% if(user.type=='buyer') {%>
                        <div class="form-group ">
                            <label for='contactNo'>Contact Number</label>
                            <input type='text' name='contactNo' value="<%=user.buyerData.contact_no%>" placeholder="Contact Number" class="form-control" required maxlength="10">
                        </div>
                        <div class="form-group ">
                            <label for='nicNumber'>NIC Number</label>
                            <input type='text' name='nicNumber' value="<%=user.buyerData.nic%>" placeholder="NIC Number" class="form-control" required maxlength="15" style="text-transform: uppercase;">
                        </div>
                        <div class="form-group">
                            <label for="district">Residential District</label>
                            <select id="district" class="form-control" name="district" required>
                                <option  selected>Choose...</option>
                                <option value="Anuradhapura">Anuradhapura</option>
                                <% if( user.buyerData.district=='Ampara') { %>
                                <option value="Ampara" selected>Ampara</option>
                                <% }else{  %>
                                <option value="Ampara">Ampara</option>
                                <% } %>
                                <% if( user.buyerData.district=='Badulla') { %>
                                <option value="Badulla" selected>Badulla</option>
                                <% }else{  %>
                                <option value="Badulla">Badulla</option>
                                <% } %>
                                <% if( user.buyerData.district=='Batticaloa') { %>
                                <option value="Batticaloa" selected>Batticaloa</option>
                                <% }else{  %>
                                <option value="Batticaloa">Batticaloa</option>
                                <% } %>
                                <% if( user.buyerData.district=='Colombo') { %>
                                <option value="Colombo" selected>Colombo</option>
                                <% }else{  %>
                                <option value="Colombo">Colombo</option>
                                <% } %>
                                <% if( user.buyerData.district=='Galle') { %>
                                <option value="Galle" selected>Galle</option>
                                <% }else{  %>
                                <option value="Galle">Galle</option>
                                <% } %>
                                <% if( user.buyerData.district=='Gampaha') { %>
                                <option value="Gampaha" selected>Gampaha</option>
                                <% }else{  %>
                                <option value="Gampaha">Gampaha</option>
                                <% } %>
                                <% if( user.buyerData.district=='Hambantota') { %>
                                <option value="Hambantota" selected>Hambantota</option>
                                <% }else{  %>
                                <option value="Hambantota">Hambantota</option>
                                <% } %>
                                <% if( user.buyerData.district=='Jaffna') { %>
                                <option value="Jaffna" selected>Jaffna</option>
                                <% }else{  %>
                                <option value="Jaffna">Jaffna</option>
                                <% } %>
                                <% if( user.buyerData.district=='Kalutara') { %>
                                <option value="Kalutara" selected>Kalutara</option>
                                <% }else{  %>
                                <option value="Kalutara">Kalutara</option>
                                <% } %>
                                <% if( user.buyerData.district=='Kandy') { %>
                                <option value="Kandy" selected>Kandy</option>
                                <% }else{  %>
                                <option value="Kandy">Kandy</option>
                                <% } %>
                                <% if( user.buyerData.district=='Kegalle') { %>
                                <option value="Kegalle" selected>Kegalle</option>
                                <% }else{  %>
                                <option value="Kegalle">Kegalle</option>
                                <% } %>
                                <% if( user.buyerData.district=='Kilinochchi') { %>
                                <option value="Kilinochchi" selected>Kilinochchi</option>
                                <% }else{  %>
                                <option value="Kilinochchi">Kilinochchi</option>
                                <% } %>
                                <% if( user.buyerData.district=='Kurunegala') { %>
                                <option value="Kurunegala" selected>Kurunegala</option>
                                <% }else{  %>
                                <option value="Kurunegala">Kurunegala</option>
                                <% } %>
                                <% if( user.buyerData.district=='Mannar') { %>
                                <option value="Mannar" selected>Mannar</option>
                                <% }else{  %>
                                <option value="Mannar">Mannar</option>
                                <% } %>
                                <% if( user.buyerData.district=='Matale') { %>
                                <option value="Matale" selected>Matale</option>
                                <% }else{  %>
                                <option value="Matale">Matale</option>
                                <% } %>
                                <% if( user.buyerData.district=='Matara') { %>
                                <option value="Matara" selected>Matara</option>
                                <% }else{  %>
                                <option value="Matara">Matara</option>
                                <% } %><% if( user.buyerData.district=='Moneragala') { %>
                                <option value="Moneragala" selected>Moneragala</option>
                                <% }else{  %>
                                <option value="Moneragala">Moneragala</option>
                                <% } %>
                                <% if( user.buyerData.district=='Mullaitivu') { %>
                                <option value="Mullaitivu" selected>Mullaitivu</option>
                                <% }else{  %>
                                <option value="Mullaitivu">Mullaitivu</option>
                                <% } %>
                                <% if( user.buyerData.district=='Nuwara Eliya') { %>
                                <option value="Nuwara Eliya" selected>Nuwara Eliya</option>
                                <% }else{  %>
                                <option value="Nuwara Eliya">Nuwara Eliya</option>
                                <% } %>
                                <% if( user.buyerData.district=='Polonnaruwa') { %>
                                <option value="Polonnaruwa" selected>Polonnaruwa</option>
                                <% }else{  %>
                                <option value="Polonnaruwa">Polonnaruwa</option>
                                <% } %>
                                <% if( user.buyerData.district=='Puttalam') { %>
                                <option value="Puttalam" selected>Puttalam</option>
                                <% }else{  %>
                                <option value="Puttalam">Puttalam</option>
                                <% } %>
                                <% if( user.buyerData.district=='Ratnapura') { %>
                                <option value="Ratnapura" selected>Ratnapura</option>
                                <% }else{  %>
                                <option value="Ratnapura">Ratnapura</option>
                                <% } %>
                                <% if( user.buyerData.district=='Trincomalee') { %>
                                <option value="Trincomalee" selected>Trincomalee</option>
                                <% }else{  %>
                                <option value="Trincomalee">Trincomalee</option>
                                <% } %>
                                <% if( user.buyerData.district=='Vavuniya') { %>
                                <option value="Vavuniya" selected>Vavuniya</option>
                                <% }else{  %>
                                <option value="Vavuniya">Vavuniya</option>
                                <% } %>
                            </select>
                          </div>
                        <%}%>
                    
                    
                    <div class="text-right">
                        <input type="submit" value='Submit and Save' class="btn btn-success">
                    </div>

                </form>
            
        </div>
    </div>

</div>
<a name='changePassword'></a>
<div class='container py-4 mt-3'>

    <form method="POST" action="/changePassword/<%=user.uid%>" class="card p-3 border border-success rounded shadow">
        <h2 class="text-center">Change Password</h2>
        <hr>
        <% if (pwd_success) { %>
            <div class="alert alert-success" role="alert">
                <%=pwd_success%>
            </div>
        <% } %>
        <% if (pwd_error) { %>
            <div class="alert alert-danger" role="alert">
                <%=pwd_error%>
            </div>
        <% } %>
        <div class="form-group">
            <label for='old_pwd'>Current Password</label>
            <input type='password' name='old_pwd' id="old_pwd" class="form-control" required maxlength="40">
        </div>
        <div class="form-group">
            <label for='new_pwd'>New Password<small> (min 6 max 20 characters long)</small></label>
            <input type='password' name='new_pwd' id="new_pwd" class="form-control" required maxlength="40">
        </div>
        <div class="form-group">
            <label for='confirm_pwd'>Confirm New Password</label>
            <input type='password' name='confirm_pwd' id="confirm_pwd" class="form-control" required maxlength="40">
        </div>
        <div class="text-right">
            <input type="submit" value='Change and Save New Password' class="btn btn-success" required>
        </div>
    </form>
</div>

<a name='delAccount'></a>
<div class="container py-4">
    <div class="card p-3 text-center shadow rounded border-danger" style="color:maroon" >
        <h3>Delete My Account</h3>
        <% if (del_acc_error) { %>
            <div class="alert alert-danger" role="alert">
                <%=del_acc_error%>
            </div>
        <% } %>
        <p>Once you have deleted your account there is no way of recovering..</p>
        <div>
            <button type="button" class="btn btn-danger" data-toggle="modal" data-target="#deleteModal">
                Delete My Account
            </button>

            <!-- Modal -->
            <div class="modal fade" id="deleteModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="exampleModalLabel">Are you sure you want to delete the account?</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                <span aria-hidden="true">&times;</span>
                            </button>
                        </div>
                        <div class="modal-body">
                            All the data will be lost and no recovery possible
                        </div>
                        <form class="p-3 text-left" method="POST" action="/deleteAccount/<%=user.uid%>">
                            
                            <div>
                                <label for="del_password">Please Enter Your Password (required)</label>
                                <input type="password" name="del_password" class="form-control" required/>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
                                <button type="submit" class="btn btn-danger">Delete Account</button>
                            </div>
                        </form>
                        
                    </div>
                </div>
            </div>
        </div>

    </div>

</div>




<%- include('_footer') %>